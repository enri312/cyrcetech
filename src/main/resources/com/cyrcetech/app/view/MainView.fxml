<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.text.Font?>
<?import javafx.scene.shape.SVGPath?>
<?import javafx.scene.chart.PieChart?>

<BorderPane xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1"
    fx:controller="com.cyrcetech.interface_adapter.controller.MainController" styleClass="root">
    <!-- Sidebar -->
    <left>
        <VBox spacing="0" styleClass="sidebar" prefWidth="220">
            <padding>
                <Insets top="20.0" bottom="20.0" />
            </padding>

            <!-- Logo/Brand -->
            <HBox alignment="CENTER_LEFT" spacing="10">
                <padding>
                    <Insets left="20" right="20" bottom="30" />
                </padding>
                <Label text="ðŸ”§" style="-fx-font-size: 24px;" />
                <Label text="%login.title"
                    style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: white;" />
            </HBox>

            <!-- Navigation Buttons -->
            <!-- Navigation Buttons -->
            <Button fx:id="homeButton" text="%nav.home" styleClass="sidebar-button, sidebar-button-active"
                maxWidth="Infinity">
                <graphic>
                    <SVGPath content="M3 3h7v7H3z M14 3h7v7h-7z M14 14h7v7h-7z M3 14h7v7H3z"
                        fill="TRANSPARENT" stroke="WHITE" strokeWidth="2" />
                </graphic>
            </Button>
            <Button fx:id="newOrderButton" text="%nav.newOrder" onAction="#handleNewTicket" styleClass="sidebar-button"
                maxWidth="Infinity">
                <graphic>
                    <SVGPath content="M12 5v14M5 12h14" fill="TRANSPARENT" stroke="WHITE"
                        strokeWidth="2" strokeLineCap="ROUND" />
                </graphic>
            </Button>
            <Button fx:id="clientsButton" text="%nav.clients" onAction="#handleClients" styleClass="sidebar-button"
                maxWidth="Infinity">
                <graphic>
                    <SVGPath
                        content="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2 M16 3.13a4 4 0 0 1 0 7.75 M23 21v-2a4 4 0 0 0-3-3.87"
                        fill="TRANSPARENT" stroke="WHITE" strokeWidth="2" strokeLineCap="ROUND"
                        strokeLineJoin="ROUND" />
                </graphic>
            </Button>
            <Button fx:id="equipmentButton" text="%nav.equipment" onAction="#handleEquipment" styleClass="sidebar-button"
                maxWidth="Infinity">
                <graphic>
                    <SVGPath content="M2 3h20v14H2z M8 21h8 M12 17v4" fill="TRANSPARENT"
                        stroke="WHITE" strokeWidth="2" strokeLineCap="ROUND" strokeLineJoin="ROUND" />
                </graphic>
            </Button>
            <Button fx:id="ordersButton" text="%nav.activeOrders" onAction="#handleOrders" styleClass="sidebar-button"
                maxWidth="Infinity">
                <graphic>
                    <SVGPath content="M8 6h13M8 12h13M8 18h13M3 6h.01M3 12h.01M3 18h.01"
                        fill="TRANSPARENT" stroke="WHITE" strokeWidth="2" strokeLineCap="ROUND"
                        strokeLineJoin="ROUND" />
                </graphic>
            </Button>
            <Button fx:id="sparePartsButton" text="%nav.spareParts" onAction="#handleSpareParts" styleClass="sidebar-button"
                maxWidth="Infinity">
                <graphic>
                    <SVGPath
                        content="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z M3.27 6.96L12 12.01l8.73-5.05 M12 22.08V12"
                        fill="TRANSPARENT" stroke="WHITE" strokeWidth="2" strokeLineCap="ROUND"
                        strokeLineJoin="ROUND" />
                </graphic>
            </Button>
            <Button fx:id="technicalHistoryButton" text="%nav.technicalHistory" onAction="#handleTechnicalHistory" styleClass="sidebar-button" maxWidth="Infinity">
                <graphic>
                    <SVGPath content="M12 22a10 10 0 1 0-10-10 10 10 0 0 0 10 10z M12 6v6l4 2"
                        fill="TRANSPARENT" stroke="WHITE" strokeWidth="2" strokeLineCap="ROUND"
                        strokeLineJoin="ROUND" />
                </graphic>
            </Button>
            <Button fx:id="auditButton" text="AuditorÃ­a" onAction="#handleAudit" styleClass="sidebar-button" maxWidth="Infinity">
                <graphic>
                    <SVGPath content="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"
                        fill="TRANSPARENT" stroke="WHITE" strokeWidth="2" strokeLineCap="ROUND"
                        strokeLineJoin="ROUND" />
                </graphic>
            </Button>
            <Button fx:id="billingButton" text="FacturaciÃ³n" onAction="#handleBilling" styleClass="sidebar-button" maxWidth="Infinity">
                <graphic>
                    <SVGPath content="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z M14 2v6h6 M16 13H8 M16 17H8 M10 9H8"
                        fill="TRANSPARENT" stroke="WHITE" strokeWidth="2" strokeLineCap="ROUND"
                        strokeLineJoin="ROUND" />
                </graphic>
            </Button>

            <!-- Spacer -->
            <VBox VBox.vgrow="ALWAYS" />

            <!-- User Info & Logout -->
            <VBox spacing="10">
                <padding>
                    <Insets left="20" right="20" top="20" />
                </padding>
                <Label fx:id="roleLabel" text="..." style="-fx-text-fill: #808090; -fx-font-size: 14px; -fx-alignment: CENTER;" maxWidth="Infinity" />
                <Button text="%nav.logout" onAction="#handleLogout" styleClass="button-danger"
                    maxWidth="Infinity">
                    <graphic>
                        <SVGPath
                            content="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4 M16 17l5-5-5-5 M21 12H9"
                            fill="TRANSPARENT" stroke="WHITE" strokeWidth="2" strokeLineCap="ROUND"
                            strokeLineJoin="ROUND" />
                    </graphic>
                </Button>
            </VBox>
        </VBox>
    </left>

    <!-- Main Content -->
    <center>
        <VBox spacing="30" style="-fx-background-color: #0f0f1a;">
            <padding>
                <Insets top="30.0" left="30.0" right="30.0" bottom="30.0" />
            </padding>

            <!-- Header -->
            <HBox alignment="CENTER_LEFT" spacing="10">
                <Label text="%main.title" styleClass="title-label">
                    <font>
                        <Font size="32.0" />
                    </font>
                </Label>
            </HBox>

            <!-- Stats Cards -->
            <GridPane hgap="20" vgap="20">
                <columnConstraints>
                    <ColumnConstraints hgrow="SOMETIMES" percentWidth="33.33" />
                    <ColumnConstraints hgrow="SOMETIMES" percentWidth="33.33" />
                    <ColumnConstraints hgrow="SOMETIMES" percentWidth="33.33" />
                </columnConstraints>

                <!-- Card 1: Pending -->
                <VBox spacing="10" styleClass="stat-card, stat-card-yellow" GridPane.columnIndex="0">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <VBox spacing="5" HBox.hgrow="ALWAYS">
                            <Label text="%main.pending" styleClass="stat-label" />
                            <Label fx:id="pendingCountLabel" text="0" styleClass="stat-number" />
                        </VBox>
                        <Label text="ðŸ”§" styleClass="icon-box, icon-box-yellow"
                            style="-fx-font-size: 24px;" />
                    </HBox>
                </VBox>

                <!-- Card 2: Ready -->
                <VBox spacing="10" styleClass="stat-card, stat-card-green" GridPane.columnIndex="1">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <VBox spacing="5" HBox.hgrow="ALWAYS">
                            <Label text="%main.ready" styleClass="stat-label" />
                            <Label fx:id="readyCountLabel" text="0" styleClass="stat-number" />
                        </VBox>
                        <Label text="âœ…" styleClass="icon-box, icon-box-green"
                            style="-fx-font-size: 24px;" />
                    </HBox>
                </VBox>

                <!-- Card 3: Delivered -->
                <VBox spacing="10" styleClass="stat-card, stat-card-blue" GridPane.columnIndex="2">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <VBox spacing="5" HBox.hgrow="ALWAYS">
                            <Label text="%main.delivered" styleClass="stat-label" />
                            <Label fx:id="deliveredCountLabel" text="0" styleClass="stat-number" />
                        </VBox>
                        <Label text="ðŸ”„" styleClass="icon-box, icon-box-blue"
                            style="-fx-font-size: 24px;" />
                    </HBox>
                </VBox>
            </GridPane>

            <!-- Content Section: Lists + Chart -->
            <HBox spacing="20" VBox.vgrow="ALWAYS">
                <!-- Left Column: Lists -->
                <VBox spacing="20" HBox.hgrow="ALWAYS">
                     <GridPane hgap="20" vgap="20">
                        <columnConstraints>
                            <ColumnConstraints hgrow="SOMETIMES" percentWidth="50" />
                            <ColumnConstraints hgrow="SOMETIMES" percentWidth="50" />
                        </columnConstraints>

                        <!-- En Taller -->
                        <VBox spacing="15" GridPane.columnIndex="0">
                            <Label text="%main.inWorkshop"
                                style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #ffcc00;" />
                            <VBox fx:id="workshopTicketsContainer" spacing="10" styleClass="glass-pane" style="-fx-padding: 15;">
                                <!-- Loaded dynamically -->
                            </VBox>
                        </VBox>

                        <!-- Para Retirar -->
                        <VBox spacing="15" GridPane.columnIndex="1">
                            <Label text="%main.toPickup"
                                style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #00ff00;" />
                            <VBox fx:id="pickupTicketsContainer" spacing="10" styleClass="glass-pane" style="-fx-padding: 15;">
                                <!-- Loaded dynamically -->
                            </VBox>
                        </VBox>
                    </GridPane>
                </VBox>

                <!-- Right Column: Analytics Chart -->
                <VBox spacing="15" styleClass="glass-pane" style="-fx-padding: 15;" minWidth="300" prefWidth="350">
                    <Label text="Estado del Taller"
                        style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: white;" />
                    <PieChart fx:id="statusChart" legendSide="BOTTOM" labelsVisible="false" VBox.vgrow="ALWAYS" />
                </VBox>
            </HBox>
        </VBox>
    </center>
</BorderPane>